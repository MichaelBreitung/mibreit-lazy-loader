var Y=Object.defineProperty;var q=(r,l,d)=>l in r?Y(r,l,{enumerable:!0,configurable:!0,writable:!0,value:d}):r[l]=d;var s=(r,l,d)=>q(r,typeof l!="symbol"?l+"":l,d);var mibreitLazyLoader=function(r){"use strict";var l=document.createElement("style");l.textContent=`.mbll__marker{display:none!important}.mbll__transition{-webkit-transition:opacity .8s ease-out;-moz-transition:opacity .8s ease-out;-o-transition:opacity .8s ease-out;transition:opacity .8s ease-out}
`,document.head.appendChild(l);function d(t){return document.createElement(t)}function y(t){t.remove()}function S(t,e){t[0].parentNode.insertBefore(e,t[0]),t.forEach(function(n){e.appendChild(n)})}function R(t){var e=t.childNodes;e.forEach(function(n){t.parentNode.insertBefore(n,t)})}function u(t){var e=t.getBoundingClientRect();return{width:e.width,height:e.height}}function c(t){var e=t.getBoundingClientRect(),n=window.innerHeight,i=window.innerWidth;return e.top+e.height>0&&e.top<n&&e.left+e.width>0&&e.left<i}function A(t){return h(t,"class")}function m(t,e){t.classList.contains(e)||t.classList.add(e)}function L(t,e){t.classList.contains(e)&&t.classList.remove(e)}function f(t,e,n){t.style.setProperty(e,n)}function b(t,e){t.style.removeProperty(e),t.style.length===0&&t.removeAttribute("style")}function p(t){t.hasAttribute("style")&&t.removeAttribute("style")}function E(t,e){e==null?p(t):t.style.cssText=e}function h(t,e){return t.hasAttribute(e)?t.getAttribute(e):null}function C(t,e,n){t.setAttribute(e,n)}function O(t,e){t.removeAttribute(e)}function D(t){document.addEventListener("scroll",t)}function v(t){return document.querySelectorAll(t)}const g="mbll__marker",w="mbll__transition",W="data-src",T="src";class N{constructor(e){s(this,"_element");s(this,"_state",0);s(this,"_wasLoadedCallbacks",new Array);s(this,"_dataSrc",null);var i;this._element=e,this._dataSrc=h(e,W);const n=(i=A(e))==null?void 0:i.split(",");this._dataSrc||n&&n.includes(g)?(this._state=0,this._setBaseStyle()):this._state=2}load(){return new Promise((e,n)=>{this._state==0?(this._element.onload=()=>{this._finishLoad(),e(!0)},this._triggerLoad(),this._state=1,this._setLoadingStyle(),this._element instanceof HTMLImageElement&&this._element.complete&&(this._element.onload=null,this._finishLoad(),e(!0))):this._state===1?n(!1):n(!0)})}wasLoaded(){return this._state===2}addWasLoadedCallback(e){this._wasLoadedCallbacks.includes(e)||this._wasLoadedCallbacks.push(e)}_triggerLoad(){this._dataSrc&&C(this._element,T,this._dataSrc),L(this._element,g)}_finishLoad(){O(this._element,W),this._state=2,this._wasLoadedCallbacks.forEach(e=>{e()}),setTimeout(()=>{this._setLoadedStyle()},50)}_setBaseStyle(){f(this._element,"opacity","0")}_setLoadingStyle(){m(this._element,w)}_setLoadedStyle(){b(this._element,"opacity"),setTimeout(()=>{L(this._element,w)},1e3)}}class H{constructor(e){s(this,"_element");s(this,"_width");s(this,"_height");s(this,"_originalElementStyle");const n=h(e,"width"),i=h(e,"height");if(n==null||i==null)throw new Error("ElementInfo#constructor - supported elements need a width and height property");const o=h(e,"class");this._element=e,this._originalElementStyle=o||"",this._width=parseInt(n),this._height=parseInt(i)}getWidth(){return this._width}getHeight(){return this._height}getStyle(){return this._originalElementStyle}isElementWithinScrollArea(){return c(this._element)}}class k extends N{constructor(n){super(n);s(this,"_elementInfo");this._elementInfo=new H(this._element)}getHtmlElement(){return this._element}getWidth(){return this._elementInfo.getWidth()}getHeight(){return this._elementInfo.getHeight()}getStyle(){return this._elementInfo.getStyle()}isElementWithinScrollArea(){return this._elementInfo.isElementWithinScrollArea()}}class z{constructor(e,n=!1){s(this,"_surrogate");s(this,"_element");this._element=e,this._surrogate=this._createSurrogate(n),S([e.getHtmlElement()],this._surrogate),e.addWasLoadedCallback(()=>{R(this._surrogate),y(this._surrogate)})}getWidth(){return this._element.getWidth()}getHeight(){return this._element.getHeight()}getStyle(){return this._element.getStyle()}isElementWithinScrollArea(){return c(this._surrogate)}_resize(e){e&&f(this._surrogate,"width",`${u(this._surrogate).height*this._element.getWidth()/this._element.getHeight()}px`)}_createSurrogate(e=!1){const n=d("div");return m(n,"mibreit_lazyLoader_surrogate"),e?(E(n,`overflow: hidden; height: 100%; width: ${u(this._element.getHtmlElement()).height*this._element.getWidth()/this._element.getHeight()}px; flex-shrink:0;`),setTimeout(()=>{this._resize(!0)},0)):E(n,`overflow: hidden; width: 100%; height: 0; padding-bottom: ${this._element.getHeight()*100/this._element.getWidth()}%;`),n}}function P(t,e){let n;return function(){const o=()=>{clearTimeout(n),t()};clearTimeout(n),n=window.setTimeout(o,e)}}const x=400;class B{constructor(e,n){s(this,"_lazyLoader");s(this,"_elementLocations",[]);this._lazyLoader=e,this._elementLocations=n}startLoader(){this._loadElementsWithinWindowRect();const e=P(()=>{this._loadElementsWithinWindowRect()},x);D(n=>{e()})}_loadElementsWithinWindowRect(){const e=this._lazyLoader.getUnloadedElementIndices();for(let n=0;n<e.length;n++)this._elementLocations[e[n]].isElementWithinScrollArea()&&this._lazyLoader.loadElement(e[n])}}const U=1;class Z{constructor(e,n=0,i=U){s(this,"_currentIndex");s(this,"_loaderWindowLeft");s(this,"_loaderWindowRight");s(this,"_unloadedElementIndices",[]);s(this,"_elementLoaders");this._currentIndex=-1,this._elementLoaders=e,this._loaderWindowLeft=n,this._loaderWindowRight=i,this._updateUnloadedElementIndices()}loadAll(){this._loadElements(0,this._elementLoaders.length)}setCurrentIndex(e){this._currentIndex!=e&&(this._currentIndex=e,this._moveWindow())}async loadElement(e){if(e>=0&&e<this._elementLoaders.length){let n=!1;if(!this._unloadedElementIndices.includes(e))n=!0;else try{if(n=await this._elementLoaders[e].load(),n){const i=this._unloadedElementIndices.indexOf(e);i>-1&&this._unloadedElementIndices.splice(i,1)}}catch(i){n=i}return n}else throw new Error(`Preloader#loadElement -> invalid Index ${e}`)}getElementLoaderInfos(){return this._elementLoaders}getUnloadedElementIndices(){return this._unloadedElementIndices}_moveWindow(){if(this._unloadedElementIndices.length){let e=this._currentIndex-this._loaderWindowLeft,n=this._currentIndex+1+this._loaderWindowRight;this._loadElements(this._currentIndex,n<this._elementLoaders.length?n:this._elementLoaders.length),this._loadElements(e>=0?e:0,this._currentIndex),e<0&&(e=this._elementLoaders.length+e,this._loadElements(e,this._elementLoaders.length)),n>=this._elementLoaders.length&&(n=n-this._elementLoaders.length,this._loadElements(0,n))}}_loadElements(e,n){for(let i=e<0?0:e;i<n&&i<this._elementLoaders.length;i++)this.loadElement(i)}_updateUnloadedElementIndices(){for(let e=0;e<this._elementLoaders.length;e++)this._elementLoaders[e].wasLoaded()||this._unloadedElementIndices.push(e)}}var a=(t=>(t[t.SIMPLE_DEFER=0]="SIMPLE_DEFER",t[t.WINDOWED_EXTERNAL=1]="WINDOWED_EXTERNAL",t[t.WINDOWED_SCROLL=2]="WINDOWED_SCROLL",t[t.WINDOWED_SCROLL_HORIZONTAL=3]="WINDOWED_SCROLL_HORIZONTAL",t))(a||{});function F(t){if(typeof t.loaderWindowRight<"u"&&(typeof t.loaderWindowRight!="number"||t.loaderWindowRight<0))throw new Error("checkLazyLoaderConfig - loaderWindowRight of config must be a number");if(typeof t.loaderWindowLeft<"u"&&(typeof t.loaderWindowLeft!="number"||t.loaderWindowLeft<0))throw new Error("checkLazyLoaderConfig - loaderWindowLeft of config must be a number");if(typeof t.mode<"u"&&(typeof t.mode!="number"||t.mode<0||t.mode>3))throw new Error("checkLazyLoaderConfig - mode of config must be a number (0, 1, 2, 3) - use type ELazyMode")}function $(t){if(typeof t!="string")throw new Error("createLazyLoader - first parameter needs to be a css selector string")}function G(t,e=a.SIMPLE_DEFER,n){if(e!=null)switch(e){case a.WINDOWED_EXTERNAL:t.loadElement(0),t.setCurrentIndex(0);break;case a.WINDOWED_SCROLL:case a.WINDOWED_SCROLL_HORIZONTAL:new B(t,n).startLoader();break;case a.SIMPLE_DEFER:default:t.loadAll();break}else t.loadAll()}function I(t,e){F(e);let n=t;if(e!=null&&e.useSurrogate){const o=[];if(e.mode===a.WINDOWED_SCROLL||e.mode===a.WINDOWED_SCROLL_HORIZONTAL)for(let _=0;_<t.length;_++){const X=new z(t[_],e.mode===a.WINDOWED_SCROLL_HORIZONTAL);o.push(X)}n=o}const i=new Z(t,e.loaderWindowLeft,e.loaderWindowRight);return setTimeout(()=>{G(i,e.mode,n)},0),i}function M(t,e){$(t);const n=v(t),i=[];for(let o=0;o<n.length;o++){const _=new k(n[o]);i.push(_)}return I(i,e)}return r.ELazyMode=a,r.createLazyLoader=M,r.createLazyLoaderFromElements=I,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r}({});
