"use strict";var S=Object.defineProperty;var p=(t,e,n)=>e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var i=(t,e,n)=>p(t,typeof e!="symbol"?e+"":e,n);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function R(t){return document.createElement(t)}function A(t){t.remove()}function O(t,e){t[0].parentNode&&(t[0].parentNode.insertBefore(e,t[0]),t.forEach(n=>{e.appendChild(n)}))}function b(t){t.parentNode&&t.childNodes.forEach(e=>{t.parentNode.insertBefore(e,t)})}function d(t){const e=t.getBoundingClientRect();return{width:e.width,height:e.height}}function L(t){const e=t.getBoundingClientRect(),n=window.innerHeight,s=window.innerWidth;return e.top+e.height>0&&e.top<n&&e.left+e.width>0&&e.left<s}function D(t){return a(t,"class")}function f(t,e){t.classList.contains(e)||t.classList.add(e)}function h(t,e){t.classList.contains(e)&&t.classList.remove(e)}function g(t,e,n){t.style.setProperty(e,n)}function C(t,e){t.style.removeProperty(e),t.style.length===0&&t.removeAttribute("style")}function N(t){t.hasAttribute("style")&&t.removeAttribute("style")}function _(t,e){e==null?N(t):t.style.cssText=e}function a(t,e){return t.hasAttribute(e)?t.getAttribute(e):null}function T(t,e,n){t.setAttribute(e,n)}function H(t,e){t.removeAttribute(e)}function k(t){document.addEventListener("scroll",t)}function v(t){return document.querySelectorAll(t)}const c="mbll__marker",u="mbll__transition",m="data-src",z="src";class x{constructor(e){i(this,"_element");i(this,"_state",0);i(this,"_wasLoadedCallbacks",new Array);i(this,"_dataSrc",null);var s;this._element=e,this._dataSrc=a(e,m);const n=(s=D(e))==null?void 0:s.split(",");this._dataSrc||n&&n.includes(c)?(this._state=0,this._setBaseStyle()):this._state=2}load(){return new Promise((e,n)=>{this._state==0?(this._element.onload=()=>{this._finishLoad(),e(!0)},this._triggerLoad(),this._state=1,this._setLoadingStyle(),this._element instanceof HTMLImageElement&&this._element.complete&&(this._element.onload=null,this._finishLoad(),e(!0))):this._state===1?n(!1):n(!0)})}wasLoaded(){return this._state===2}addWasLoadedCallback(e){this._wasLoadedCallbacks.includes(e)||this._wasLoadedCallbacks.push(e)}_triggerLoad(){this._dataSrc&&T(this._element,z,this._dataSrc),h(this._element,c)}_finishLoad(){H(this._element,m),this._state=2,this._wasLoadedCallbacks.forEach(e=>{e()}),setTimeout(()=>{this._setLoadedStyle()},50)}_setBaseStyle(){g(this._element,"opacity","0")}_setLoadingStyle(){f(this._element,u)}_setLoadedStyle(){C(this._element,"opacity"),setTimeout(()=>{h(this._element,u)},1e3)}}class P{constructor(e){i(this,"_element");i(this,"_width");i(this,"_height");i(this,"_originalElementStyle");const n=a(e,"width"),s=a(e,"height");if(n==null||s==null)throw new Error("ElementInfo#constructor - supported elements need a width and height property");const r=a(e,"class");this._element=e,this._originalElementStyle=r||"",this._width=parseInt(n),this._height=parseInt(s)}getWidth(){return this._width}getHeight(){return this._height}getStyle(){return this._originalElementStyle}isElementWithinScrollArea(){return L(this._element)}}class E extends x{constructor(n){super(n);i(this,"_elementInfo");this._elementInfo=new P(this._element)}getHtmlElement(){return this._element}getWidth(){return this._elementInfo.getWidth()}getHeight(){return this._elementInfo.getHeight()}getStyle(){return this._elementInfo.getStyle()}isElementWithinScrollArea(){return this._elementInfo.isElementWithinScrollArea()}}class B{constructor(e,n=!1){i(this,"_surrogate");i(this,"_element");this._element=e,this._surrogate=this._createSurrogate(n),O([e.getHtmlElement()],this._surrogate),e.addWasLoadedCallback(()=>{b(this._surrogate),A(this._surrogate)})}getWidth(){return this._element.getWidth()}getHeight(){return this._element.getHeight()}getStyle(){return this._element.getStyle()}isElementWithinScrollArea(){return L(this._surrogate)}_resize(e){e&&g(this._surrogate,"width",`${d(this._surrogate).height*this._element.getWidth()/this._element.getHeight()}px`)}_createSurrogate(e=!1){const n=R("div");return f(n,"mibreit_lazyLoader_surrogate"),e?(_(n,`overflow: hidden; height: 100%; width: ${d(this._element.getHtmlElement()).height*this._element.getWidth()/this._element.getHeight()}px; flex-shrink:0;`),setTimeout(()=>{this._resize(!0)},0)):_(n,`overflow: hidden; width: 100%; height: 0; padding-bottom: ${this._element.getHeight()*100/this._element.getWidth()}%;`),n}}function F(t,e){let n;return function(){const r=()=>{clearTimeout(n),t()};clearTimeout(n),n=window.setTimeout(r,e)}}const U=400;class w{constructor(e,n){i(this,"_lazyLoader");i(this,"_elementLocations",[]);this._lazyLoader=e,this._elementLocations=n}startLoader(){this._loadElementsWithinWindowRect();const e=F(()=>{this._loadElementsWithinWindowRect()},U);k(n=>{e()})}_loadElementsWithinWindowRect(){const e=this._lazyLoader.getUnloadedElementIndices();for(let n=0;n<e.length;n++)this._elementLocations[e[n]].isElementWithinScrollArea()&&this._lazyLoader.loadElement(e[n])}}const Z=1;class W{constructor(e,n=0,s=Z){i(this,"_currentIndex");i(this,"_loaderWindowLeft");i(this,"_loaderWindowRight");i(this,"_unloadedElementIndices",[]);i(this,"_elementLoaders");this._currentIndex=-1,this._elementLoaders=e,this._loaderWindowLeft=n,this._loaderWindowRight=s,this._updateUnloadedElementIndices()}async loadAll(){await this._loadElements(0,this._elementLoaders.length)}async setCurrentIndex(e){this._currentIndex!=e&&(this._currentIndex=e,await this._moveWindow())}async loadElement(e){if(e>=0&&e<this._elementLoaders.length){let n=!1;if(!this._unloadedElementIndices.includes(e))n=!0;else try{if(n=await this._elementLoaders[e].load(),n){const s=this._unloadedElementIndices.indexOf(e);s>-1&&this._unloadedElementIndices.splice(s,1)}}catch(s){n=s}return n}else throw new Error(`Preloader#loadElement -> invalid Index ${e}`)}getElementLoaderInfos(){return this._elementLoaders}getUnloadedElementIndices(){return this._unloadedElementIndices}async _moveWindow(){if(this._unloadedElementIndices.length){let e=this._currentIndex-this._loaderWindowLeft,n=this._currentIndex+1+this._loaderWindowRight;await this._loadElements(this._currentIndex,n<this._elementLoaders.length?n:this._elementLoaders.length),await this._loadElements(e>=0?e:0,this._currentIndex),e<0&&(e=this._elementLoaders.length+e,await this._loadElements(e,this._elementLoaders.length)),n>=this._elementLoaders.length&&(n=n-this._elementLoaders.length,await this._loadElements(0,n))}}async _loadElements(e,n){for(let s=e<0?0:e;s<n&&s<this._elementLoaders.length;s++)await this.loadElement(s)}_updateUnloadedElementIndices(){for(let e=0;e<this._elementLoaders.length;e++)this._elementLoaders[e].wasLoaded()||this._unloadedElementIndices.push(e)}}var o=(t=>(t[t.SIMPLE_DEFER=0]="SIMPLE_DEFER",t[t.WINDOWED_EXTERNAL=1]="WINDOWED_EXTERNAL",t[t.WINDOWED_SCROLL=2]="WINDOWED_SCROLL",t[t.WINDOWED_SCROLL_HORIZONTAL=3]="WINDOWED_SCROLL_HORIZONTAL",t))(o||{});function $(t){if(typeof t.loaderWindowRight<"u"&&(typeof t.loaderWindowRight!="number"||t.loaderWindowRight<0))throw new Error("checkLazyLoaderConfig - loaderWindowRight of config must be a number");if(typeof t.loaderWindowLeft<"u"&&(typeof t.loaderWindowLeft!="number"||t.loaderWindowLeft<0))throw new Error("checkLazyLoaderConfig - loaderWindowLeft of config must be a number");if(typeof t.mode<"u"&&(typeof t.mode!="number"||t.mode<0||t.mode>3))throw new Error("checkLazyLoaderConfig - mode of config must be a number (0, 1, 2, 3) - use type ELazyMode")}function G(t){if(typeof t!="string")throw new Error("createLazyLoader - first parameter needs to be a css selector string")}async function M(t,e=o.SIMPLE_DEFER,n){if(e!=null)switch(e){case o.WINDOWED_EXTERNAL:await t.loadElement(0),t.setCurrentIndex(0);break;case o.WINDOWED_SCROLL:case o.WINDOWED_SCROLL_HORIZONTAL:new w(t,n).startLoader();break;case o.SIMPLE_DEFER:default:t.loadAll();break}else t.loadAll()}function I(t,e){$(e);let n=t;if(e!=null&&e.useSurrogate){const r=[];if(e.mode===o.WINDOWED_SCROLL||e.mode===o.WINDOWED_SCROLL_HORIZONTAL)for(let l=0;l<t.length;l++){const y=new B(t[l],e.mode===o.WINDOWED_SCROLL_HORIZONTAL);r.push(y)}n=r}const s=new W(t,e.loaderWindowLeft,e.loaderWindowRight);return setTimeout(()=>{M(s,e.mode,n)},0),s}function X(t,e){G(t);const n=v(t),s=[];for(let r=0;r<n.length;r++){const l=new E(n[r]);s.push(l)}return I(s,e)}exports.ELazyMode=o;exports.Element=E;exports.LazyLoader=W;exports.ScrollLoader=w;exports.createLazyLoader=X;exports.createLazyLoaderFromElements=I;
